<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pusat Belajar Bahasa Inggris</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.7.77/Tone.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka+One&family=Inter:wght@400;700&display=swap" rel="stylesheet">
    <style>
        html {
            height: 100%;
        }
        body { 
            font-family: 'Inter', sans-serif; 
            overflow-x: hidden; /* Mencegah scroll horizontal */
        }
        .font-fredoka { font-family: 'Fredoka One', cursive; }
        .card { transition: all 0.3s ease; position: relative; z-index: 10; }
        .btn { transition: all 0.2s ease-in-out; }
        .btn:hover { transform: scale(1.05); }
        .correct-answer { animation: correct-pulse 0.5s ease; }
        .wrong-answer { animation: wrong-shake 0.5s ease; }
        @keyframes correct-pulse { 0% { transform: scale(1); } 50% { transform: scale(1.1); } 100% { transform: scale(1); } }
        @keyframes wrong-shake { 0%, 100% { transform: translateX(0); } 20%, 60% { transform: translateX(-10px); } 40%, 80% { transform: translateX(10px); } }
        
        /* Floating Icons */
        .floating-icon {
            position: absolute;
            font-size: 2rem;
            opacity: 0.5;
            animation: float 15s infinite ease-in-out;
            z-index: 1;
        }
        @keyframes float {
            0% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(180deg); }
            100% { transform: translateY(0) rotate(360deg); }
        }

        /* Memory Game */
        .memory-card { width: 100%; aspect-ratio: 1 / 1; position: relative; transform-style: preserve-3d; transition: transform 0.5s; cursor: pointer; }
        .memory-card.is-flipped { transform: rotateY(180deg); }
        .card-face { position: absolute; width: 100%; height: 100%; backface-visibility: hidden; display: flex; align-items: center; justify-content: center; border-radius: 0.75rem; font-size: 1.5rem; }
        .card-front { background-color: #4a90e2; color: white; font-size: 2.5rem; }
        .card-back { background-color: #f7fafc; transform: rotateY(180deg); }
        .card-back-emoji { font-size: 2.5rem; }
        .card-back-text { font-weight: bold; color: #2d3748; }

        /* Drag and Drop */
        .drop-zone { border: 2px dashed #a0aec0; min-height: 60px; }
        .word-tile { cursor: grab; }
        .word-tile:active { cursor: grabbing; }
        
        /* Color Match */
        .color-swatch { width: 60px; height: 60px; cursor: pointer; border: 4px solid transparent; }
        .color-swatch.selected { border-color: #3182ce; box-shadow: 0 0 10px #3182ce; }
        .color-name-box { cursor: pointer; border: 2px solid #ddd; }

        /* Alphabet Canvas */
        #alphabet-canvas {
            border: 2px solid #e2e8f0;
            background-color: #f7fafc;
            border-radius: 0.5rem;
            display: block;
            width: 90%;
            max-width: 400px; /* Batasi lebar maksimum di layar besar */
            aspect-ratio: 4 / 1; /* Jaga agar bentuknya proporsional */
            margin: 0 auto; /* Pusatkan kanvas */
        }
    </style>
</head>
<body class="bg-blue-50 flex items-center justify-center min-h-screen p-4">
    
    <div id="floating-container"></div>

    <div id="game-container" class="w-full max-w-lg mx-auto">
        
        <!-- Menu Screen -->
        <div id="menu-screen" class="card bg-white p-6 md:p-8 rounded-2xl shadow-xl text-center">
            <h2 class="text-xl md:text-2xl font-fredoka text-gray-500">BAHASA INGGRIS ITU MUDAH</h2>
            <h1 class="text-4xl md:text-5xl font-fredoka text-blue-600 mb-6">Ayo Belajar!</h1>
            <div id="menu-buttons" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <!-- Buttons will be generated by JS -->
            </div>
        </div>

        <!-- Generic Game Screen Wrapper -->
        <div id="game-wrapper" class="hidden">
            <div id="tebak-kata-screen" class="game-content card bg-white p-6 md:p-8 rounded-2xl shadow-xl text-center"></div>
            <div id="abjad-screen" class="game-content card bg-white p-6 md:p-8 rounded-2xl shadow-xl text-center"></div>
            <div id="susun-kalimat-screen" class="game-content card bg-white p-6 md:p-8 rounded-2xl shadow-xl text-center"></div>
            <div id="kartu-memori-screen" class="game-content card bg-white p-6 md:p-8 rounded-2xl shadow-xl text-center"></div>
            <div id="cocokkan-warna-screen" class="game-content card bg-white p-6 md:p-8 rounded-2xl shadow-xl text-center"></div>
            <div id="kartu-kilas-screen" class="game-content card bg-white p-6 md:p-8 rounded-2xl shadow-xl text-center"></div>
            <button class="btn-back-to-menu w-full mt-6 bg-gray-500 hover:bg-gray-600 text-white font-bold py-3 px-6 rounded-xl text-lg shadow-lg">Kembali ke Menu</button>
        </div>

    </div>

    <script>
    document.addEventListener('DOMContentLoaded', () => {

        // --- DATA ---
        const vocabulary = [ { english: 'Apple', indonesian: 'Apel', emoji: 'üçé' }, { english: 'Ball', indonesian: 'Bola', emoji: '‚öΩ' }, { english: 'Car', indonesian: 'Mobil', emoji: 'üöó' }, { english: 'Dog', indonesian: 'Anjing', emoji: 'üê∂' }, { english: 'Cat', indonesian: 'Kucing', emoji: 'üê±' }, { english: 'Sun', indonesian: 'Matahari', emoji: '‚òÄÔ∏è' }, { english: 'House', indonesian: 'Rumah', emoji: 'üè†' }, { english: 'Tree', indonesian: 'Pohon', emoji: 'üå≥' }, { english: 'Book', indonesian: 'Buku', emoji: 'üìñ' }, { english: 'Fish', indonesian: 'Ikan', emoji: 'üêü' }, { english: 'Banana', indonesian: 'Pisang', emoji: 'üçå' }, { english: 'Lion', indonesian: 'Singa', emoji: 'ü¶Å' }, { english: 'Flower', indonesian: 'Bunga', emoji: 'üå∏' }, { english: 'Boat', indonesian: 'Perahu', emoji: '‚õµ' } ];
        const colors = [ { name: 'Red', hex: '#ef4444' }, { name: 'Blue', hex: '#3b82f6' }, { name: 'Green', hex: '#22c55e' }, { name: 'Yellow', hex: '#eab308' }, { name: 'Purple', hex: '#8b5cf6' }, { name: 'Orange', hex: '#f97316' } ];
        const sentences = [ { english: "The cat is black", indonesian: "Kucing itu hitam", words: ["The", "cat", "is", "black"] }, { english: "I see a big car", indonesian: "Saya melihat mobil besar", words: ["I", "see", "a", "big", "car"] }, { english: "A dog runs fast", indonesian: "Seekor anjing berlari cepat", words: ["A", "dog", "runs", "fast"] } ];
        const alphabet = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'.split('');
        const menuOptions = [
            { id: 'tebak-kata', name: 'Tebak Kata', icon: 'üßê', color: 'bg-red-400', hover: 'hover:bg-red-500' },
            { id: 'abjad', name: 'Mengenal Abjad', icon: 'üî§', color: 'bg-blue-400', hover: 'hover:bg-blue-500' },
            { id: 'susun-kalimat', name: 'Susun Kalimat', icon: '‚úçÔ∏è', color: 'bg-green-400', hover: 'hover:bg-green-500' },
            { id: 'kartu-memori', name: 'Kartu Memori', icon: 'üß†', color: 'bg-yellow-400', hover: 'hover:bg-yellow-500' },
            { id: 'cocokkan-warna', name: 'Cocokkan Warna', icon: 'üé®', color: 'bg-purple-400', hover: 'hover:bg-purple-500' },
            { id: 'kartu-kilas', name: 'Kartu Kilas', icon: '‚ö°', color: 'bg-pink-400', hover: 'hover:bg-pink-500' }
        ];

        // --- DOM Elements ---
        const menuScreen = document.getElementById('menu-screen');
        const gameWrapper = document.getElementById('game-wrapper');
        const gameScreens = document.querySelectorAll('.game-content');
        const backButtons = document.querySelectorAll('.btn-back-to-menu');
        
        // --- Sound & Speech ---
        const synth = new Tone.Synth().toDestination();
        function speak(text, lang = 'en-US') { if ('speechSynthesis' in window) { const utterance = new SpeechSynthesisUtterance(text); utterance.lang = lang; utterance.rate = 0.9; window.speechSynthesis.speak(utterance); } }
        
        // --- Utility ---
        function shuffleArray(array) { for (let i = array.length - 1; i > 0; i--) { const j = Math.floor(Math.random() * (i + 1)); [array[i], array[j]] = [array[j], array[i]]; } return array; }

        // --- Menu & Navigation ---
        function initMenu() {
            const menuButtonsContainer = document.getElementById('menu-buttons');
            menuButtonsContainer.innerHTML = menuOptions.map(opt => `
                <button data-game="${opt.id}" class="btn w-full font-bold py-4 px-4 rounded-xl text-lg shadow-md text-white ${opt.color} ${opt.hover}">
                    ${opt.name} ${opt.icon}
                </button>
            `).join('');
            menuButtonsContainer.querySelectorAll('.btn').forEach(button => {
                button.addEventListener('click', () => {
                    const gameId = button.dataset.game;
                    showGame(gameId);
                });
            });
            initFloatingIcons();
        }

        function initFloatingIcons() {
            const container = document.getElementById('floating-container');
            if (!container) return;
            container.innerHTML = '';
            const icons = ['üçé', '‚öΩ', 'üöó', 'üê∂', 'üê±', '‚òÄÔ∏è', 'üè†', 'üå≥', 'üìñ', 'üêü', 'üçå', 'ü¶Å'];
            for (let i = 0; i < 12; i++) {
                const iconEl = document.createElement('div');
                iconEl.classList.add('floating-icon');
                iconEl.textContent = icons[i % icons.length];
                iconEl.style.left = `${Math.random() * 100}vw`;
                iconEl.style.top = `${Math.random() * 100}vh`;
                iconEl.style.animationDelay = `${Math.random() * 15}s`;
                iconEl.style.animationDuration = `${10 + Math.random() * 10}s`;
                container.appendChild(iconEl);
            }
        }

        backButtons.forEach(button => button.addEventListener('click', showMenu));

        function showMenu() { gameWrapper.classList.add('hidden'); menuScreen.classList.remove('hidden'); }

        function showGame(gameId) {
            menuScreen.classList.add('hidden');
            gameWrapper.classList.remove('hidden');
            gameScreens.forEach(screen => screen.classList.add('hidden'));
            const activeScreen = document.getElementById(`${gameId}-screen`);
            activeScreen.classList.remove('hidden');
            
            switch(gameId) {
                case 'tebak-kata': initTebakKata(); break;
                case 'abjad': initAbjad(); break;
                case 'susun-kalimat': initSusunKalimat(); break;
                case 'kartu-memori': initKartuMemori(); break;
                case 'cocokkan-warna': initCocokkanWarna(); break;
                case 'kartu-kilas': initKartuKilas(); break;
            }
        }
        
        // --- GAME INITIALIZERS ---
        
        function initAbjad() {
            const screen = document.getElementById('abjad-screen');
            let currentWord = '';
            screen.innerHTML = `
                <h2 class="text-3xl font-fredoka text-purple-600 mb-4">Mengenal Abjad</h2>
                <p class="text-gray-600 mb-4">Klik huruf untuk menyusun kata di kanvas.</p>
                <canvas id="alphabet-canvas"></canvas>
                <div class="flex justify-center gap-4 my-4">
                    <button id="read-word-btn" class="btn bg-green-500 text-white font-bold py-2 px-6 rounded-lg">Bacakan</button>
                    <button id="clear-canvas-btn" class="btn bg-red-500 text-white font-bold py-2 px-6 rounded-lg">Hapus</button>
                </div>
                <div class="grid grid-cols-5 sm:grid-cols-6 md:grid-cols-7 gap-2">
                    ${alphabet.map(letter => `<button data-letter="${letter}" class="btn bg-white border-2 border-purple-200 text-purple-700 font-bold text-2xl p-4 rounded-lg shadow-sm">${letter}</button>`).join('')}
                </div>
            `;
            
            const canvas = document.getElementById('alphabet-canvas');
            const ctx = canvas.getContext('2d');

            function drawWordOnCanvas() {
                // Setel resolusi kanvas agar sesuai dengan ukuran tampilannya untuk teks yang tajam
                canvas.width = canvas.clientWidth;
                canvas.height = canvas.clientHeight;

                ctx.clearRect(0, 0, canvas.width, canvas.height);
                // Buat ukuran font responsif terhadap tinggi kanvas
                ctx.font = `${canvas.height * 0.6}px Fredoka One`;
                ctx.fillStyle = '#333';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.fillText(currentWord, canvas.width / 2, canvas.height / 2);
            }

            screen.querySelectorAll('button[data-letter]').forEach(btn => {
                btn.addEventListener('click', () => {
                    Tone.start();
                    speak(btn.dataset.letter);
                    // Batasi panjang kata untuk mencegah luapan
                    if (currentWord.length < 15) {
                        currentWord += btn.dataset.letter;
                    }
                    drawWordOnCanvas();
                });
            });

            document.getElementById('read-word-btn').addEventListener('click', () => {
                if(currentWord) speak(currentWord);
            });

            document.getElementById('clear-canvas-btn').addEventListener('click', () => {
                currentWord = '';
                drawWordOnCanvas();
            });
            
            // Gambar awal untuk mengatur ukuran dengan benar
            // Gunakan timeout kecil untuk memastikan elemen telah dirender dan memiliki dimensi
            setTimeout(drawWordOnCanvas, 0);
        }

        function initSusunKalimat() {
            const screen = document.getElementById('susun-kalimat-screen');
            let currentSentence;

            function setupSentence() {
                currentSentence = shuffleArray([...sentences])[0];
                const shuffledWords = shuffleArray([...currentSentence.words]);
                screen.innerHTML = `
                    <h2 class="text-3xl font-fredoka text-teal-600 mb-2">Susun Kalimat</h2>
                    <p class="mb-4 text-gray-600">Susun kata-kata di bawah menjadi kalimat yang benar.</p>
                    <div id="drop-zone" class="drop-zone p-4 mb-4 rounded-lg bg-gray-100 flex flex-wrap gap-2"></div>
                    <div id="word-bank" class="flex flex-wrap gap-2 justify-center">
                        ${shuffledWords.map((word, index) => `<div id="word-${index}" draggable="true" class="word-tile bg-teal-500 text-white font-bold p-3 rounded-lg shadow">${word}</div>`).join('')}
                    </div>
                    <div id="feedback-susun-kalimat" class="mt-4 text-xl font-bold h-8"></div>
                    <div id="translation-susun-kalimat" class="mt-2 text-lg text-gray-700 h-8"></div>
                    <button id="next-sentence" class="btn w-full mt-4 bg-teal-500 text-white font-bold py-2 px-4 rounded-lg hidden">Lanjut</button>
                `;
                const dropZone = screen.querySelector('#drop-zone');
                const wordTiles = screen.querySelectorAll('.word-tile');
                wordTiles.forEach(tile => { tile.addEventListener('dragstart', e => { e.dataTransfer.setData('text/plain', e.target.id); }); });
                dropZone.addEventListener('dragover', e => e.preventDefault());
                dropZone.addEventListener('drop', e => { e.preventDefault(); const id = e.dataTransfer.getData('text'); const draggedElement = document.getElementById(id); if (draggedElement) { dropZone.appendChild(draggedElement); checkSentence(); } });
            }

            function checkSentence() {
                const dropZone = screen.querySelector('#drop-zone');
                const wordsInZone = Array.from(dropZone.children).map(child => child.textContent);
                const constructedSentence = wordsInZone.join(' ');
                const feedbackEl = screen.querySelector('#feedback-susun-kalimat');
                if (constructedSentence === currentSentence.english) {
                    feedbackEl.textContent = 'Hebat, benar! üëç';
                    feedbackEl.className = 'mt-4 text-xl font-bold h-8 text-green-500';
                    screen.querySelector('#translation-susun-kalimat').textContent = `Artinya: ${currentSentence.indonesian}`;
                    speak(currentSentence.english);
                    synth.triggerAttackRelease('G5', '0.2s');
                    screen.querySelector('#next-sentence').classList.remove('hidden');
                    screen.querySelector('#next-sentence').onclick = setupSentence;
                }
            }
            setupSentence();
        }

        function initKartuMemori() {
            const screen = document.getElementById('kartu-memori-screen');
            let moves, firstCard, secondCard, lockBoard, matchedPairs;
            const PAIRS_TO_MATCH = 6;

            function startGame() {
                moves = 0; matchedPairs = 0; lockBoard = false; firstCard = secondCard = null;
                const gameVocab = shuffleArray([...vocabulary]).slice(0, PAIRS_TO_MATCH);
                const cards = shuffleArray([...gameVocab, ...gameVocab]);
                screen.innerHTML = `
                    <h2 class="text-3xl font-fredoka text-orange-600 mb-2">Kartu Memori</h2>
                    <div class="flex justify-between items-center mb-4">
                        <div class="text-lg font-bold">Gerakan: <span id="moves-counter">0</span></div>
                        <button id="restart-memori" class="btn bg-orange-500 text-white text-sm font-bold py-1 px-3 rounded-md">Mulai Ulang</button>
                    </div>
                    <div id="memory-board" class="grid grid-cols-3 sm:grid-cols-4 gap-2 md:gap-4">
                        ${cards.map(item => `
                            <div class="memory-card" data-id="${item.english}">
                                <div class="card-face card-front">?</div>
                                <div class="card-face card-back">
                                    ${item.emoji ? `<span class="card-back-emoji">${item.emoji}</span>` : `<span class="card-back-text">${item.english}</span>`}
                                </div>
                            </div>`).join('')}
                    </div>
                    <div id="feedback-memori" class="mt-4 text-xl font-bold h-8"></div>`;
                document.getElementById('restart-memori').addEventListener('click', startGame);
                document.querySelectorAll('.memory-card').forEach(card => card.addEventListener('click', flipCard));
            }

            function flipCard() {
                if (lockBoard || this === firstCard) return;
                this.classList.add('is-flipped');
                if (!firstCard) { firstCard = this; return; }
                secondCard = this;
                moves++;
                document.getElementById('moves-counter').textContent = moves;
                lockBoard = true;
                checkForMatch();
            }

            function checkForMatch() { const isMatch = firstCard.dataset.id === secondCard.dataset.id; isMatch ? disableCards() : unflipCards(); }

            function disableCards() {
                firstCard.removeEventListener('click', flipCard);
                secondCard.removeEventListener('click', flipCard);
                matchedPairs++;
                synth.triggerAttackRelease('C5', '0.2s');
                speak(firstCard.dataset.id); 
                if (matchedPairs === PAIRS_TO_MATCH) { document.getElementById('feedback-memori').textContent = `Selesai dalam ${moves} gerakan!`; }
                resetBoard();
            }

            function unflipCards() { setTimeout(() => { firstCard.classList.remove('is-flipped'); secondCard.classList.remove('is-flipped'); resetBoard(); }, 1200); }
            function resetBoard() { [firstCard, secondCard, lockBoard] = [null, null, false]; }
            startGame();
        }

        function initCocokkanWarna() {
            const screen = document.getElementById('cocokkan-warna-screen');
            let selectedColor = null; let matchedCount = 0;
            
            function setupGame() {
                matchedCount = 0; selectedColor = null;
                const shuffledColors = shuffleArray([...colors]);
                const shuffledNames = shuffleArray([...colors]);
                screen.innerHTML = `
                    <h2 class="text-3xl font-fredoka text-pink-600 mb-4">Cocokkan Warna</h2>
                    <p class="mb-4 text-gray-600">Klik sebuah warna, lalu klik nama yang benar.</p>
                    <div id="color-swatches" class="flex justify-center gap-3 mb-4">
                        ${shuffledColors.map(c => `<div class="color-swatch rounded-lg shadow-md" data-name="${c.name}" style="background-color: ${c.hex};"></div>`).join('')}
                    </div>
                    <div id="color-names" class="grid grid-cols-3 gap-3">
                        ${shuffledNames.map(c => `<div class="color-name-box text-xl font-bold p-3 rounded-lg bg-white shadow-sm" data-name="${c.name}">${c.name}</div>`).join('')}
                    </div>
                    <div id="feedback-warna" class="mt-4 text-xl font-bold h-8"></div>`;

                screen.querySelectorAll('.color-swatch').forEach(swatch => {
                    swatch.addEventListener('click', () => {
                        screen.querySelectorAll('.color-swatch').forEach(s => s.classList.remove('selected'));
                        swatch.classList.add('selected');
                        selectedColor = swatch;
                    });
                });

                screen.querySelectorAll('.color-name-box').forEach(nameEl => {
                    nameEl.addEventListener('click', () => {
                        if (!selectedColor) return;
                        if (selectedColor.dataset.name === nameEl.dataset.name) {
                            selectedColor.style.visibility = 'hidden';
                            nameEl.style.visibility = 'hidden';
                            speak(nameEl.dataset.name);
                            synth.triggerAttackRelease('E5', '0.2s');
                            matchedCount++;
                            if (matchedCount === colors.length) {
                                const feedbackEl = screen.querySelector('#feedback-warna');
                                feedbackEl.textContent = 'Semua warna cocok!';
                                feedbackEl.classList.add('text-green-500');
                            }
                        } else { synth.triggerAttackRelease('C4', '0.2s'); }
                        selectedColor.classList.remove('selected');
                        selectedColor = null;
                    });
                });
            }
            setupGame();
        }

        function initTebakKata() {
            const screen = document.getElementById('tebak-kata-screen');
            let score, currentQuestionIndex, questions;
            const TOTAL_QUESTIONS_PER_GAME = 5;

            function startGame() {
                score = 0; currentQuestionIndex = 0;
                questions = shuffleArray([...vocabulary]).slice(0, TOTAL_QUESTIONS_PER_GAME);
                displayQuestion();
            }

            function displayQuestion() {
                if (currentQuestionIndex >= TOTAL_QUESTIONS_PER_GAME) { showFinalScore(); return; }
                const q = questions[currentQuestionIndex];
                const options = shuffleArray([q.english, ...shuffleArray(vocabulary.filter(v => v.english !== q.english)).slice(0, 3).map(v => v.english)]);
                screen.innerHTML = `<div class="flex justify-between items-center mb-4"><div class="text-lg font-bold text-blue-600">Skor: ${score}</div><div class="text-lg font-bold text-gray-500">${currentQuestionIndex + 1} / ${TOTAL_QUESTIONS_PER_GAME}</div></div><p class="text-xl text-gray-700 mb-2">Apa bahasa Inggrisnya untuk <strong>${q.indonesian}</strong>?</p><div class="text-7xl md:text-8xl my-4">${q.emoji}</div><div class="grid grid-cols-2 gap-4 mt-6">${options.map(opt => `<button data-answer="${opt}" class="btn bg-blue-500 hover:bg-blue-600 text-white font-bold py-4 px-3 rounded-xl text-lg md:text-xl shadow-md">${opt}</button>`).join('')}</div><div id="feedback-tebak-kata" class="mt-6 text-2xl font-bold h-8"></div>`;
                screen.querySelectorAll('button[data-answer]').forEach(btn => btn.addEventListener('click', () => checkAnswer(btn.dataset.answer, q.english)));
            }

            function checkAnswer(selected, correct) {
                const buttons = screen.querySelectorAll('button[data-answer]');
                buttons.forEach(b => b.disabled = true);
                const feedbackEl = document.getElementById('feedback-tebak-kata');
                const selectedBtn = screen.querySelector(`button[data-answer="${selected}"]`);
                if (selected === correct) {
                    score += 10;
                    feedbackEl.textContent = 'Benar! üéâ';
                    feedbackEl.className = 'mt-6 text-2xl font-bold h-8 text-green-500';
                    selectedBtn.classList.replace('bg-blue-500', 'bg-green-500');
                    selectedBtn.classList.add('correct-answer');
                    synth.triggerAttackRelease('C5', '0.2s');
                    speak(correct);
                } else {
                    feedbackEl.textContent = 'Salah, coba lagi!';
                    feedbackEl.className = 'mt-6 text-2xl font-bold h-8 text-red-500';
                    selectedBtn.classList.replace('bg-blue-500', 'bg-red-500');
                    selectedBtn.classList.add('wrong-answer');
                    screen.querySelector(`button[data-answer="${correct}"]`).classList.replace('bg-blue-500', 'bg-green-500');
                    synth.triggerAttackRelease('C4', '0.4s');
                }
                setTimeout(() => { currentQuestionIndex++; displayQuestion(); }, 2000);
            }

            function showFinalScore() {
                screen.innerHTML = `<h2 class="text-3xl font-fredoka text-yellow-500">Kerja Bagus!</h2><p class="text-gray-600 mt-4 text-xl">Skor akhir kamu adalah:</p><p class="text-6xl font-bold text-blue-600 my-6">${score}</p><button id="play-again-tebak-kata" class="btn w-full bg-blue-500 hover:bg-blue-600 text-white font-bold py-4 px-6 rounded-xl text-2xl shadow-lg">Main Lagi</button>`;
                document.getElementById('play-again-tebak-kata').addEventListener('click', startGame);
            }
            startGame();
        }

        function initKartuKilas() {
            const screen = document.getElementById('kartu-kilas-screen');
            let currentIndex = 0;
            const shuffledVocab = shuffleArray([...vocabulary]);
            function showCard() {
                const item = shuffledVocab[currentIndex];
                screen.innerHTML = `<h2 class="text-3xl font-fredoka text-cyan-600 mb-4">Kartu Kilas</h2><div class="bg-gray-100 p-6 rounded-lg shadow-inner"><div class="text-8xl">${item.emoji}</div><div class="text-4xl font-bold mt-4">${item.english}</div><div class="text-xl text-gray-500">${item.indonesian}</div></div><button id="next-kilas" class="btn w-full mt-6 bg-cyan-500 hover:bg-cyan-600 text-white font-bold py-3 px-6 rounded-xl text-lg shadow-lg">Lanjut</button>`;
                speak(item.english);
                document.getElementById('next-kilas').addEventListener('click', () => { currentIndex = (currentIndex + 1) % shuffledVocab.length; showCard(); });
            }
            showCard();
        }

        // --- Initial setup ---
        initMenu();
        showMenu();
        document.body.addEventListener('click', () => Tone.start(), { once: true });

    });
    </script>
</body>
</html>
